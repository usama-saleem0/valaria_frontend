import React, { useEffect, useState } from "react";


import logo from "../img/Past-1.png";
import axios from "axios";
import { baseurl } from "../baseurl";
import { toast } from "react-toastify";



const Dash3ah = () => {
  const cards = Array.from({ length: 3 }); // Create an array with 8 elements

  const [sortOrder, setSortOrder] = useState("newest");


  const sortratings = (rating) => {
    return rating.sort((a, b) => {
      const dateA = new Date(a.createdAt);  // Use createdAt for sorting
      const dateB = new Date(b.createdAt);
      console.log('BAsit', sortOrder)

      if (sortOrder === 'Newest') {
        return dateB - dateA;
      } else {
        return dateA - dateB;  // Sort by oldest first
      }
    });
  };


  const [userdata, setUser] = useState([]);


  useEffect(() => {


    fetchUserData();

  }, []);


  const Approval = async (e) => {

    console.log("iiii", e);
    const id = e;

    try {
      const response = await axios.post(`${baseurl}/approvenewsdirectorbyadmin`, { id });
      console.log('response', response)
      fetchUserData();
      toast.success('NewsRoom Approved Successfully')

    } catch (error) {
      console.error("Error fetching user data:", error);
    }

  }

  const DenyDirector = async (email) => {
    try {
      const response = await axios.post(`${baseurl}/denynewsdirectorbyadmin`, { email });
      console.log('response', response);
      fetchUserData(); // Optionally refresh the list of directors
      toast.success('Director Denied and Deleted Successfully');
    } catch (error) {
      console.error("Error denying director:", error);
      toast.error('Failed to deny the director');
    }
  };

  const fetchUserData = async () => {
    try {
      const response = await axios.get(`${baseurl}/getnewdirectors`);
      console.log('response', response)
      setUser(response.data.message);
    } catch (error) {
      console.error("Error fetching user data:", error);
    }
  };


  return (

    <>

      <section className="ah1">

        <div className="ahd-box-1">
          <h2>New News Direction Approval Request</h2>
          <p>All requests will be automatically approved if you don't take action within 10 days</p>

          <div className="ahd-box-btn">


            {/* <div className="ahd-box-btn-card">
                    <button>Approve all</button>
                    <button className="Deny"> Deny all</button>
                </div> */}


            <div class="filter-box">
              <p>Sort:</p>
              <select
                name="sortOrder"
                id="sortOrder"
                value={sortOrder}
                onChange={(e) => setSortOrder(e.target.value)}
              >
                <option value="Newest">Newest</option>
                <option value="Oldest">Oldest</option>
              </select>
            </div>


          </div>


        </div>


        <div className="ahd-box-2">
          {sortratings(userdata).map((yes, index) => (
            <div className="ahd-card" key={index}>

              <div className="ahd-card-head">
                <p><span>{yes.User ? yes.User.username : ''}</span> submitted this <span>news director..</span></p>

                <span className="approved-s"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none">
                  <path d="M16.9647 8.36608C16.8831 9.75797 16.5222 11.0081 15.8864 12.0821C15.2463 13.1647 14.3184 14.0797 13.137 14.7928C11.8139 15.5919 10.4306 16 9.03439 16C7.89167 16 6.71887 15.7251 5.55037 15.1881C4.4592 14.6854 3.51839 13.9036 2.74941 12.8554C2.47017 12.473 2.52602 12.0048 2.88259 11.7427C3.23915 11.4764 3.70311 11.5623 3.98665 11.936C4.9962 13.2807 6.32794 14.0926 7.93893 14.3418C10.9891 14.8143 13.8888 13.1647 14.9886 10.325C16.1442 7.34364 14.9671 4.01428 12.1919 2.399C9.64442 0.925488 6.23343 1.45819 4.25729 3.65342C3.57423 4.4138 3.08879 5.28159 2.81815 6.24388C3.09309 6.13648 3.40669 6.19662 3.62579 6.41142C3.77614 6.55749 3.85777 6.74651 3.85777 6.94842C3.85777 7.15892 3.77185 7.36083 3.6129 7.52408C3.26922 7.87205 2.81385 8.32742 2.34559 8.78709C2.16946 8.96322 1.94607 9.04484 1.71838 9.02336C1.49499 9.00188 1.29738 8.8816 1.15991 8.67969C0.893559 8.28876 0.627209 7.88923 0.373748 7.50689C0.292125 7.38231 0.206206 7.25343 0.124583 7.12885C0.094511 7.08589 0.0730312 7.04293 0.0515515 7.00426C0.0429596 6.99138 0.0343676 6.97419 0.0257757 6.96131L0 6.90116V6.51453L0.0300717 6.45868C0.279237 5.98612 0.665873 5.81429 1.0654 5.99901C1.13843 6.03338 1.20287 6.08063 1.25871 6.13219C2.03199 3.15509 3.92221 1.20043 6.87353 0.315463C8.35134 -0.127021 9.93655 -0.101245 11.4573 0.397086C12.9695 0.891121 14.2755 1.79757 15.2378 3.02191C16.4965 4.62001 17.0764 6.42001 16.9647 8.36608ZM9.51984 3.66631C9.51984 3.19375 9.19764 2.85008 8.75086 2.84578H8.74656C8.54036 2.84578 8.35134 2.92311 8.20957 3.06058C8.05921 3.21094 7.97329 3.42144 7.97329 3.65772C7.97329 4.25056 7.97329 4.8434 7.97329 5.43624V5.5866C7.97329 6.45868 7.97329 7.33505 7.97329 8.20713C7.97329 8.50785 8.09788 8.75272 8.34274 8.93315C8.77234 9.24675 9.20194 9.57325 9.62294 9.88685C9.77759 10.0028 9.93654 10.1231 10.0912 10.2391C10.2244 10.3379 10.3575 10.441 10.495 10.5398C10.7786 10.7503 11.0578 10.9651 11.3413 11.1713C11.4874 11.283 11.6463 11.3346 11.8096 11.3346C11.9471 11.3346 12.0845 11.2959 12.2134 11.2143C12.484 11.0511 12.6172 10.7632 12.57 10.4367C12.5313 10.1661 12.3552 9.99855 12.2005 9.88256C11.874 9.63769 11.5475 9.39282 11.2253 9.14365L11.1136 9.06203C10.5852 8.6625 10.0611 8.26728 9.53272 7.86775C9.52413 7.85916 9.51984 7.85486 9.51554 7.85486C9.51554 7.85057 9.51554 7.84627 9.51554 7.83768C9.51984 7.31787 9.51984 6.78517 9.51984 6.27395C9.51984 6.10211 9.51984 5.93028 9.51984 5.75414V5.11834C9.51984 4.63719 9.51984 4.15175 9.51984 3.66631Z" fill="#828282" />
                </svg><p> automatically approved in 3 days</p></span>
              </div>

              <div className="ahd-card-body">
                <div className="ahd-card-body-start">
                  <div className="ahd-card-body-start-1">
                    <div className="sevenplus">
                      <img src={yes.image} alt="" />
                      <a> Current</a>

                    </div>
                    <span>
                      <h2>{yes.name}</h2>
                      <p>News Director at <span>{yes.User ? yes.User.username : ''}</span></p>
                    </span>
                  </div>
                  <div className="ahd-card-body-start-btn">
                    {/* <button onClick={()=> Approval(yes.id)}>Approve</button> */}

                    {/* 
          {
              yes.verified_account == 1 ?
              <button style={{background:'#89c400' , border:'none'}}>Approved</button>
              :
              <button onClick={()=> Approval(yes.id)}>Approve</button>

            }
           <button className="Deny" onClick={() => DenyDirector(yes.email)}>Deny</button> */}

                    {
                      yes && yes.verified_account === 1 ? (
                        <button style={{ background: '#89c400', border: 'none' }}>Approved</button>
                      ) : (
                        <button onClick={() => Approval(yes?.id)}>Approve</button>
                      )
                    }
                    <button className="Deny" onClick={() => yes && DenyDirector(yes.email)}>Deny</button>
                  </div>
                </div>

                <div className="ahd-card-body-end">
                  <span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="20" viewBox="0 0 25 20" fill="none">
                      <path d="M0 5.50036C1.5873 6.52058 3.18182 7.54079 4.76912 8.56101C7.04185 10.0228 9.32179 11.4846 11.5945 12.9616C12.2006 13.3575 12.7706 13.3499 13.3766 12.9616C17.1501 10.5253 20.9235 8.10419 24.7042 5.67547C24.7836 5.62218 24.8701 5.56888 25 5.49275C25 5.61456 25 5.70593 25 5.78968C25 8.99498 25 12.1927 25 15.398C25 17.7582 23.4055 19.4408 21.1472 19.4408C15.8225 19.4408 10.4906 19.4408 5.16595 19.4408C4.45887 19.4408 3.74459 19.4712 3.05195 19.357C1.47908 19.1058 0.2886 17.781 0.050505 16.1441C0.04329 16.0984 0.021645 16.0527 0 16.0071C0 12.5048 0 9.00259 0 5.50036ZM3.81674 0.0033838C2.06349 0.0109973 0.627706 1.12257 0.17316 2.81278C0.122655 2.99551 0.151515 3.08687 0.30303 3.18584C4.32179 5.75922 8.33333 8.34021 12.3377 10.9212C12.4675 11.005 12.5613 10.9973 12.684 10.9136C13.1674 10.5938 13.6508 10.2817 14.1414 9.96951C17.6407 7.70829 21.14 5.45468 24.6465 3.20107C24.8268 3.08687 24.8846 2.97267 24.798 2.77471C24.697 2.53108 24.632 2.27222 24.5022 2.04381C23.7734 0.680989 22.6479 0.0109973 21.1616 0.0033838C18.2756 -0.00422975 15.3896 0.0033838 12.4964 0.0033838C9.60318 0.0033838 6.70996 0.0033838 3.81674 0.0033838Z" fill="#828282" />
                    </svg>
                    <p>{yes.email}</p>
                  </span>


                  <span className="sl-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="142" height="21" viewBox="0 0 142 21" fill="none">
                      <path d="M132.936 20C131.617 20 130.323 20 129.011 20C129.011 15.7861 129.011 11.5721 129.011 7.3396C130.249 7.3396 131.493 7.3396 132.775 7.3396C132.775 7.90353 132.775 8.46125 132.775 9.02518C133.047 8.70913 133.276 8.38689 133.555 8.12042C134.248 7.46354 135.096 7.12891 136.037 7.04215C136.848 6.96779 137.659 7.02356 138.445 7.27144C139.752 7.68044 140.525 8.59759 140.909 9.88656C141.163 10.7355 141.256 11.6155 141.262 12.4955C141.281 14.9495 141.274 17.3973 141.274 19.8513C141.274 19.8823 141.268 19.9132 141.262 19.9628C139.962 19.9628 138.662 19.9628 137.331 19.9628C137.331 19.8699 137.331 19.7831 137.331 19.6902C137.331 17.5956 137.337 15.501 137.325 13.4064C137.325 12.9664 137.281 12.5265 137.201 12.0927C136.96 10.7913 136.118 10.3389 134.898 10.4877C133.802 10.624 133.202 11.2685 133.035 12.4645C132.973 12.8983 132.948 13.3445 132.942 13.7782C132.929 15.7551 132.936 17.7381 132.936 19.7149C132.936 19.8017 132.936 19.8947 132.936 20ZM126.516 7.33341C125.204 7.33341 123.91 7.33341 122.61 7.33341C122.61 11.5597 122.61 15.7799 122.61 20C123.922 20 125.216 20 126.516 20C126.516 15.7613 126.516 11.5473 126.516 7.33341ZM124.541 1.00011C123.297 1.01251 122.275 2.0412 122.275 3.28059C122.275 4.54477 123.322 5.59206 124.572 5.58586C125.816 5.57967 126.838 4.53238 126.832 3.2744C126.825 2.01022 125.798 0.987718 124.541 1.00011Z" fill="#828282" />
                      <path d="M98.2754 4.01231C97.5284 4.35358 96.7324 4.57979 95.9025 4.68962C96.7562 4.15876 97.4078 3.32454 97.7142 2.31904C96.9182 2.81329 96.0393 3.16241 95.1027 3.35723C94.3468 2.5191 93.2696 2 92.0944 2C89.8143 2 87.9787 3.92732 87.9787 6.29006C87.9787 6.63002 88.0064 6.95691 88.0742 7.2681C84.6503 7.0942 81.6207 5.38524 79.5854 2.78191C79.2301 3.42392 79.0217 4.15876 79.0217 4.94982C79.0217 6.4352 79.7562 7.75189 80.851 8.51419C80.1894 8.50112 79.5402 8.30106 78.9903 7.98594C78.9903 7.99902 78.9903 8.01602 78.9903 8.03302C78.9903 10.1172 80.4179 11.8484 82.2899 12.2472C81.9546 12.3427 81.5893 12.3885 81.2101 12.3885C80.9464 12.3885 80.6803 12.3728 80.4304 12.3152C80.964 14.0137 82.4782 15.2624 84.2787 15.303C82.8775 16.4445 81.0984 17.1322 79.1724 17.1322C78.8346 17.1322 78.5107 17.1165 78.1868 17.0734C80.0111 18.2986 82.1731 18.9981 84.5046 18.9981C92.0831 18.9981 96.2264 12.4604 96.2264 6.79346C96.2264 6.60387 96.2201 6.42081 96.2113 6.23906C97.0287 5.63498 97.7155 4.88052 98.2754 4.01231Z" fill="#828282" />
                      <path d="M52.6495 6.61132C52.6028 5.59721 52.4317 4.90002 52.1865 4.29589C51.9336 3.65463 51.5444 3.08051 51.0346 2.60323C50.5365 2.11854 49.9334 1.7419 49.2718 1.50334C48.6377 1.26842 47.9138 1.10443 46.8554 1.05971C45.7891 1.01121 45.4506 1 42.7462 1C40.0417 1 39.7032 1.01121 38.6408 1.05593C37.5824 1.10064 36.8548 1.26478 36.2244 1.49955C35.555 1.7419 34.9558 2.11475 34.4577 2.60323C33.9518 3.08051 33.5589 3.65842 33.3097 4.29225C33.0646 4.90002 32.8934 5.59342 32.8467 6.60753C32.7961 7.62922 32.7844 7.95356 32.7844 10.5448C32.7844 13.1361 32.7961 13.4605 32.8428 14.4784C32.8895 15.4925 33.0608 16.1897 33.3059 16.7938C33.5589 17.435 33.9518 18.0092 34.4577 18.4864C34.9558 18.9711 35.559 19.3478 36.2205 19.5863C36.8548 19.8213 37.5785 19.9852 38.637 20.03C39.6992 20.0748 40.0379 20.0859 42.7424 20.0859C45.4468 20.0859 45.7853 20.0748 46.8477 20.03C47.9061 19.9852 48.6337 19.8213 49.2641 19.5863C50.6028 19.0904 51.6612 18.0763 52.1788 16.7938C52.4238 16.186 52.5951 15.4925 52.6418 14.4784C52.6884 13.4605 52.7001 13.1361 52.7001 10.5448C52.7001 7.95356 52.6962 7.62922 52.6495 6.61132ZM50.8557 14.4038C50.8128 15.3359 50.6494 15.8392 50.5132 16.1748C50.1785 17.0063 49.4898 17.6662 48.622 17.9869C48.2718 18.1174 47.7427 18.2739 46.7736 18.3149C45.723 18.3597 45.4079 18.3708 42.7501 18.3708C40.0923 18.3708 39.7733 18.3597 38.7264 18.3149C37.7536 18.2739 37.2283 18.1174 36.878 17.9869C36.4462 17.834 36.0531 17.5916 35.7341 17.2747C35.4033 16.9652 35.1504 16.5924 34.9908 16.1786C34.8546 15.843 34.6912 15.3359 34.6484 14.4076C34.6016 13.4009 34.5901 13.0988 34.5901 10.5523C34.5901 8.0057 34.6016 7.7 34.6484 6.6971C34.6912 5.76499 34.8546 5.26165 34.9908 4.92609C35.1504 4.51217 35.4033 4.13569 35.738 3.82984C36.0609 3.51292 36.45 3.27057 36.882 3.11779C37.2322 2.98729 37.7615 2.83073 38.7304 2.78966C39.781 2.74494 40.0963 2.73373 42.7539 2.73373C45.4156 2.73373 45.7307 2.74494 46.7776 2.78966C47.7504 2.83073 48.2758 2.98729 48.626 3.11779C49.0578 3.27057 49.4509 3.51292 49.7699 3.82984C50.1007 4.13933 50.3536 4.51217 50.5132 4.92609C50.6494 5.26165 50.8128 5.76863 50.8557 6.6971C50.9024 7.70379 50.9141 8.0057 50.9141 10.5523C50.9141 13.0988 50.9024 13.3971 50.8557 14.4038Z" fill="#828282" />
                      <path d="M42.7464 5.64183C39.9214 5.64183 37.6293 7.83783 37.6293 10.5447C37.6293 13.2517 39.9214 15.4477 42.7464 15.4477C45.5715 15.4477 47.8634 13.2517 47.8634 10.5447C47.8634 7.83783 45.5715 5.64183 42.7464 5.64183ZM42.7464 13.7251C40.9137 13.7251 39.4271 12.3009 39.4271 10.5447C39.4271 8.78859 40.9137 7.36435 42.7464 7.36435C44.5793 7.36435 46.0657 8.78859 46.0657 10.5447C46.0657 12.3009 44.5793 13.7251 42.7464 13.7251Z" fill="#828282" />
                      <path d="M49.2605 5.44805C49.2605 6.08014 48.7256 6.59266 48.0658 6.59266C47.4061 6.59266 46.8712 6.08014 46.8712 5.44805C46.8712 4.81582 47.4061 4.30344 48.0658 4.30344C48.7256 4.30344 49.2605 4.81582 49.2605 5.44805Z" fill="#828282" />
                      <path d="M8.4536 0.00411242L6.34663 0C3.97951 0 2.44977 1.90919 2.44977 4.86417V7.10687H0.331302C0.148241 7.10687 0 7.28741 0 7.5101V10.7595C0 10.9822 0.14841 11.1625 0.331302 11.1625H2.44977V19.3619C2.44977 19.5846 2.59801 19.7649 2.78108 19.7649H5.54508C5.72814 19.7649 5.87638 19.5844 5.87638 19.3619V11.1625H8.35337C8.53643 11.1625 8.68467 10.9822 8.68467 10.7595L8.68568 7.5101C8.68568 7.40317 8.65069 7.30077 8.58866 7.22511C8.52662 7.14944 8.44211 7.10687 8.35421 7.10687H5.87638V5.2057C5.87638 4.29192 6.05538 3.82804 7.03391 3.82804L8.45326 3.82743C8.63616 3.82743 8.7844 3.64689 8.7844 3.42441V0.407129C8.7844 0.184853 8.63632 0.00452366 8.4536 0.00411242Z" fill="#828282" />
                    </svg>
                  </span>
                </div>

              </div>

            </div>
          ))}
        </div>


      </section>

    </>

  )

}



export default Dash3ah