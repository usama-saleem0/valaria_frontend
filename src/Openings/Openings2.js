import React, { useEffect, useState } from "react";


import Assistant from '../img/Assistant.png'
import axios from "axios";
import { baseurl } from "../baseurl";



const Openings2 = ({ onSuccess }) => {

    const [jobContent, setjobContent] = useState([]);

    useEffect(() => {

        fetchJobsData();

    }, []);


    const getUserFromLocalStorage = () => {
        const user = localStorage.getItem('userData');
        return user ? JSON.parse(user) : null;
    };



    const fetchJobsData = async () => {

        const storedUser = getUserFromLocalStorage();
        console.log('Retrieved user from local storage:', storedUser);
        const userId = storedUser.id;

        try {
            const response = await axios.get(`${baseurl}/getjobbyuserid/${userId}`);
            console.log('xxxxx', response.data)
            setjobContent(response.data)





        } catch (error) {
            console.error('Error fetching user data:', error);
        }
    };

    const sendIds = (jobId) => {
        localStorage.setItem('jobgetId', JSON.stringify(jobId));
        onSuccess()

    }


    const calculateHoursAgo = (createdAt) => {
        const createdDate = new Date(createdAt);
        const currentDate = new Date();
        const diffInMilliseconds = currentDate - createdDate;
        const diffInHours = Math.floor(diffInMilliseconds / (1000 * 60 * 60));
        return diffInHours;
    };

    const [showAll, setShowAll] = useState(false);

    // Toggle the state to show all jobs
    const handleShowAll = () => {
        setShowAll(true);
    };



    return (



        <>

            <div class="About-main-card-1-ah">
                <h2>Job Opening <span>({jobContent.length})</span></h2>


                {(showAll ? jobContent : jobContent.slice(0, 3)).map((job, index) => (

                    <div class="Job-ah">

                        <div class="Job-box-ah" onClick={() => sendIds(job.id)}>
                            <div class="Job-logo-ah">
                                <img src={Assistant} alt="" />
                            </div>

                            <div class="Job-card-ah">

                                <div class="Job-list-1-ah">
                                    <span>
                                        <h2>{job.jobTitle}</h2>
                                        <p>{job.jobType}</p>
                                    </span>

                                    <svg xmlns="http://www.w3.org/2000/svg" width="21" height="27" viewBox="0 0 21 27" fill="none">
                                        <path d="M13.8423 3.56754C13.8423 5.45693 12.3106 6.98859 10.4212 6.98859C8.53181 6.98859 7.00015 5.45693 7.00015 3.56754C7.00015 1.67814 8.53181 0.146484 10.4212 0.146484C12.3106 0.146484 13.8423 1.67814 13.8423 3.56754Z" fill="#828282" />
                                        <path d="M13.8421 13.1465C13.8421 15.0359 12.3104 16.5675 10.4211 16.5675C8.53166 16.5675 7 15.0359 7 13.1465C7 11.2571 8.53166 9.72541 10.4211 9.72541C12.3104 9.72541 13.8421 11.2571 13.8421 13.1465Z" fill="#828282" />
                                        <path d="M13.8421 22.7254C13.8421 24.6148 12.3104 26.1464 10.4211 26.1464C8.53166 26.1464 7 24.6148 7 22.7254C7 20.836 8.53166 19.3043 10.4211 19.3043C12.3104 19.3043 13.8421 20.836 13.8421 22.7254Z" fill="#828282" />
                                    </svg>
                                </div>

                                <div class="Job-list-2-ah">
                                    <span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="18" viewBox="0 0 15 18" fill="none">
                                            <path d="M0.761719 7.71196C0.761719 4.50477 2.5523 2.002 5.28759 1.13216C9.23126 -0.127227 13.3397 2.11406 14.0757 6.15372C14.4602 8.2456 13.9384 10.1293 12.5598 11.7783C11.0823 13.5447 9.57729 15.295 8.0888 17.056C7.68785 17.5309 7.27041 17.5309 6.86396 17.056C5.32604 15.2416 3.77165 13.4379 2.2557 11.6022C1.23957 10.3802 0.778196 8.95 0.761719 7.71196ZM7.47364 4.62218C6.01261 4.62751 4.8372 5.78018 4.8427 7.19966C4.84819 8.60314 6.04008 9.73979 7.49561 9.73446C8.94015 9.72912 10.1265 8.57112 10.1156 7.16764C10.1046 5.75883 8.91818 4.61684 7.47364 4.62218Z" fill="#194D79" />
                                        </svg>
                                        <p>{job.yearofexperience} year of Experiance</p>
                                    </span>

                                    <span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                                            <path d="M8.10671 0.530029C8.45896 0.530029 8.8112 0.530029 9.16344 0.530029C9.20747 0.538835 9.2471 0.552044 9.29113 0.556447C9.72263 0.622493 10.1629 0.66212 10.59 0.758987C13.8395 1.5031 16.3976 4.21977 16.948 7.50883C17.0008 7.81704 17.0317 8.12525 17.0757 8.43787C17.0757 8.79011 17.0757 9.14235 17.0757 9.4946C17.0669 9.52542 17.0537 9.55624 17.0493 9.58706C16.992 9.97893 16.9612 10.3752 16.8775 10.7583C15.768 15.9891 10.0044 18.8819 5.15228 16.6539C1.56822 15.0116 -0.391131 11.2074 0.357384 7.33711C1.01344 3.92917 3.76093 1.23892 7.18208 0.657717C7.49029 0.604881 7.7985 0.57406 8.10671 0.530029ZM9.95158 10.8067C9.95599 11.5156 9.37919 12.1144 8.68351 12.132C7.9482 12.1496 7.34939 11.5948 7.31417 10.8595C7.30096 10.5073 7.08081 10.2783 6.76819 10.2871C6.46438 10.2959 6.24864 10.5513 6.25744 10.8948C6.27946 11.8634 6.93551 12.744 7.86455 13.0522C8.03627 13.1095 8.12433 13.1931 8.10231 13.3825C8.0891 13.4837 8.09791 13.5894 8.10231 13.6951C8.10671 14.0077 8.33127 14.2367 8.62627 14.2411C8.91247 14.2455 9.14583 14.0077 9.15904 13.7039C9.16344 13.607 9.15904 13.5058 9.15904 13.4089C9.15904 13.1447 9.15904 13.1447 9.40561 13.0566C10.9555 12.5063 11.5059 10.6262 10.4888 9.34489C10.022 8.75489 9.3968 8.45988 8.64388 8.44227C7.92179 8.42466 7.34939 7.88749 7.31417 7.19621C7.27894 6.47412 7.83813 5.84448 8.54702 5.80926C9.29553 5.76963 9.91636 6.33322 9.94718 7.08174C9.96039 7.43398 10.1805 7.66294 10.4932 7.65413C10.797 7.64532 11.0259 7.38995 10.9951 7.04651C10.9731 6.79554 10.9335 6.54016 10.8498 6.3068C10.5856 5.58911 10.0749 5.10918 9.34837 4.86701C9.21187 4.82298 9.15023 4.75253 9.15904 4.60723C9.16784 4.47955 9.16344 4.35626 9.15904 4.22857C9.15023 3.92917 8.92568 3.70461 8.63508 3.70021C8.35769 3.69581 8.12433 3.92036 8.10671 4.20656C8.09791 4.32544 8.09351 4.44872 8.10671 4.56761C8.12433 4.74813 8.04067 4.83179 7.87335 4.88462C6.67573 5.2809 6.00207 6.55778 6.34991 7.76861C6.64051 8.7813 7.54313 9.47698 8.60426 9.499C9.37038 9.51221 9.94718 10.0714 9.95158 10.8067Z" fill="#194D79" />
                                        </svg>
                                        <p>${job.yearlySalary}</p>
                                    </span>

                                    <span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="17" height="14" viewBox="0 0 17 14" fill="none">
                                            <path d="M0.0742188 12.2672C0.0742188 10.4173 0.0742188 8.56736 0.0742188 6.71306C0.091671 6.71742 0.10476 6.71742 0.122212 6.72178C2.70515 7.58131 5.28808 8.44083 7.86666 9.30472C8.24188 9.43125 8.60838 9.43561 8.9836 9.31344C11.5273 8.46265 14.0753 7.61621 16.619 6.76978C16.6713 6.75232 16.728 6.73487 16.7848 6.71742C16.7891 6.75232 16.7935 6.76978 16.7935 6.78723C16.7935 8.55427 16.7979 10.3257 16.7848 12.0927C16.7848 12.337 16.7193 12.5945 16.6146 12.817C16.2481 13.5849 15.6198 13.947 14.769 13.9427C10.5499 13.9383 6.33522 13.9427 2.11613 13.9427C2.04196 13.9427 1.96343 13.9427 1.88925 13.9383C1.08209 13.9078 0.357818 13.3318 0.144028 12.5508C0.122212 12.4592 0.100397 12.3632 0.0742188 12.2672ZM0.0742188 5.60484C0.0873079 5.61356 0.10476 5.62229 0.117849 5.62665C2.81859 6.52544 5.51933 7.4286 8.22443 8.31866C8.35968 8.3623 8.52984 8.35793 8.6651 8.3143C11.3309 7.43296 13.9968 6.5429 16.6626 5.65719C16.7717 5.62229 16.7979 5.56993 16.7979 5.46086C16.7935 5.0071 16.7935 4.5577 16.7935 4.10394C16.7935 2.92155 15.9776 2.10129 14.7952 2.10129C13.6695 2.10129 12.5439 2.10129 11.4138 2.10129C11.3527 2.10129 11.2873 2.10129 11.2175 2.10129C11.2175 1.87442 11.2219 1.68244 11.2175 1.4861C11.2131 1.3683 11.2131 1.24613 11.1913 1.12833C11.0517 0.460782 10.5107 0.0157488 9.81258 0.0113857C8.89198 0.00265956 7.97137 0.00702263 7.05076 0.0113857C6.95477 0.0113857 6.85442 0.0201118 6.75844 0.0375641C6.10834 0.177182 5.66767 0.705113 5.65022 1.3683C5.64149 1.60391 5.65022 1.84387 5.65022 2.09693C5.56296 2.09693 5.49751 2.09693 5.43206 2.09693C4.28894 2.09693 3.14582 2.09257 2.00269 2.09693C1.13881 2.11002 0.414538 2.63795 0.16148 3.44948C0.126576 3.55856 0.100397 3.66764 0.0742188 3.77671C0.0742188 4.38754 0.0742188 4.99837 0.0742188 5.60484ZM7.0464 1.41629C7.96701 1.41629 8.88761 1.41629 9.82131 1.41629C9.82131 1.63881 9.82131 1.85696 9.82131 2.09257C8.9007 2.09257 7.98446 2.09257 7.0464 2.09257C7.0464 1.86133 7.0464 1.64754 7.0464 1.41629Z" fill="#194D79" />
                                        </svg>
                                        <p>{job.jobType}</p>
                                    </span>
                                </div>

                                <div class="Job-list-3-ah">
                                    {job.active = 1 ?
                                        <button>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
                                                <path d="M8.53345 16.5189C4.28236 16.5411 0.761921 13.0472 0.744208 8.79612C0.726495 4.46974 4.18494 0.984727 8.52017 0.958158C12.7713 0.931588 16.2961 4.44317 16.3094 8.72084C16.3271 13.0162 12.851 16.5012 8.53345 16.5189ZM7.82051 9.5622C7.75409 9.47363 7.72752 9.41607 7.68324 9.37621C7.19613 8.88468 6.7046 8.39758 6.21749 7.91047C6.0138 7.70677 5.77024 7.62264 5.49126 7.70234C4.95988 7.8529 4.80489 8.49057 5.20343 8.89354C5.87652 9.57105 6.55404 10.2486 7.23156 10.9217C7.6301 11.3202 8.0065 11.3202 8.40947 10.9217C9.26854 10.0626 10.1276 9.20351 10.9867 8.34444C11.2701 8.06103 11.5491 7.78205 11.8325 7.49865C12.0362 7.29052 12.1026 7.04697 12.0185 6.76799C11.8546 6.24546 11.2214 6.11261 10.8184 6.51558C9.86192 7.46765 8.90985 8.41972 7.95779 9.37621C7.9135 9.41607 7.88693 9.47363 7.82051 9.5622Z" fill="white" />
                                            </svg>
                                            Actively Hiring
                                        </button>
                                        :

                                        <button style={{ background: '#df0000;', border: 'none' }}>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
                                                <path d="M8.53345 16.5189C4.28236 16.5411 0.761921 13.0472 0.744208 8.79612C0.726495 4.46974 4.18494 0.984727 8.52017 0.958158C12.7713 0.931588 16.2961 4.44317 16.3094 8.72084C16.3271 13.0162 12.851 16.5012 8.53345 16.5189ZM7.82051 9.5622C7.75409 9.47363 7.72752 9.41607 7.68324 9.37621C7.19613 8.88468 6.7046 8.39758 6.21749 7.91047C6.0138 7.70677 5.77024 7.62264 5.49126 7.70234C4.95988 7.8529 4.80489 8.49057 5.20343 8.89354C5.87652 9.57105 6.55404 10.2486 7.23156 10.9217C7.6301 11.3202 8.0065 11.3202 8.40947 10.9217C9.26854 10.0626 10.1276 9.20351 10.9867 8.34444C11.2701 8.06103 11.5491 7.78205 11.8325 7.49865C12.0362 7.29052 12.1026 7.04697 12.0185 6.76799C11.8546 6.24546 11.2214 6.11261 10.8184 6.51558C9.86192 7.46765 8.90985 8.41972 7.95779 9.37621C7.9135 9.41607 7.88693 9.47363 7.82051 9.5622Z" fill="white" />
                                            </svg>
                                            Closed Hiring
                                        </button>
                                    }

                                    <a href="#">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17" viewBox="0 0 18 17" fill="none">
                                            <path d="M17.4296 8.76147C17.3479 10.1534 16.9871 11.4035 16.3513 12.4775C15.7112 13.5601 14.7833 14.4751 13.6019 15.1882C12.2787 15.9873 10.8954 16.3954 9.49924 16.3954C8.35651 16.3954 7.18372 16.1204 6.01522 15.5834C4.92405 15.0808 3.98323 14.299 3.21426 13.2507C2.93502 12.8684 2.99087 12.4001 3.34743 12.1381C3.70399 11.8717 4.16796 11.9577 4.45149 12.3314C5.46104 13.676 6.79279 14.488 8.40377 14.7371C11.4539 15.2097 14.3537 13.5601 15.4534 10.7204C16.609 7.73903 15.432 4.40967 12.6568 2.79439C10.1093 1.32087 6.69827 1.85357 4.72214 4.04881C4.03908 4.80919 3.55364 5.67697 3.28299 6.63927C3.55793 6.53187 3.87154 6.59201 4.09063 6.80681C4.24099 6.95287 4.32261 7.14189 4.32261 7.3438C4.32261 7.55431 4.23669 7.75622 4.07774 7.91946C3.73407 8.26743 3.27869 8.72281 2.81044 9.18247C2.6343 9.35861 2.41091 9.44023 2.18323 9.41875C1.95984 9.39727 1.76222 9.27698 1.62475 9.07507C1.3584 8.68414 1.09205 8.28462 0.838592 7.90228C0.756969 7.77769 0.67105 7.64882 0.589426 7.52423C0.559355 7.48127 0.537875 7.43831 0.516395 7.39965C0.507803 7.38676 0.499211 7.36958 0.490619 7.35669L0.464844 7.29655V6.90991L0.494915 6.85406C0.744081 6.38151 1.13072 6.20967 1.53024 6.3944C1.60327 6.42876 1.66771 6.47602 1.72356 6.52757C2.49683 3.55047 4.38705 1.59582 7.33837 0.710848C8.81618 0.268365 10.4014 0.294141 11.9222 0.792471C13.4343 1.28651 14.7403 2.19295 15.7026 3.4173C16.9613 5.0154 17.5413 6.8154 17.4296 8.76147ZM9.98468 4.06169C9.98468 3.58914 9.66248 3.24546 9.2157 3.24117H9.21141C9.0052 3.24117 8.81618 3.31849 8.67441 3.45596C8.52406 3.60632 8.43814 3.81682 8.43814 4.0531C8.43814 4.64594 8.43814 5.23879 8.43814 5.83163V5.98199C8.43814 6.85406 8.43814 7.73044 8.43814 8.60252C8.43814 8.90323 8.56272 9.1481 8.80759 9.32853C9.23718 9.64214 9.66678 9.96863 10.0878 10.2822C10.2424 10.3982 10.4014 10.5185 10.556 10.6345C10.6892 10.7333 10.8224 10.8364 10.9599 10.9352C11.2434 11.1457 11.5226 11.3605 11.8062 11.5667C11.9522 11.6784 12.1112 11.73 12.2744 11.73C12.4119 11.73 12.5494 11.6913 12.6782 11.6097C12.9489 11.4464 13.0821 11.1586 13.0348 10.8321C12.9961 10.5615 12.82 10.3939 12.6654 10.2779C12.3389 10.0331 12.0124 9.7882 11.6902 9.53904L11.5785 9.45741C11.0501 9.05789 10.526 8.66266 9.99757 8.26314C9.98898 8.25455 9.98468 8.25025 9.98038 8.25025C9.98038 8.24595 9.98038 8.24166 9.98038 8.23307C9.98468 7.71325 9.98468 7.18056 9.98468 6.66934C9.98468 6.4975 9.98468 6.32566 9.98468 6.14953V5.51373C9.98468 5.03258 9.98468 4.54714 9.98468 4.06169Z" fill="#828282" />
                                        </svg>
                                        Updated {calculateHoursAgo(job.createdAt)} hours ago
                                    </a>
                                </div>

                            </div>

                        </div>



                    </div>

                ))}

                {!showAll && jobContent.length > 3 && (
                    <div class="Award-a" onClick={handleShowAll}>   
                        <a href="#">{jobContent.length - 3}+ more</a>
                    </div>
                )}
            </div>
        </>
    )
}



export default Openings2
